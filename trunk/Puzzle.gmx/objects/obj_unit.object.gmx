<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>msk_player</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>msk_player</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>movespeed = 0
gravity = 0.5
gravity_direction = 270
friction = 0.1
destx = x
desty = y
group = 1
switchtarget = noone //If the units are moving towards a button, switch, etc. then they need a target
standby = false //Is the unit able to be controlled at the moment?

drive = round(random(360))

scale = 0.3
dir = 1
image_yscale = scale
image_xscale = scale
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//If there is nothing 4 pixels above this little bastard
if(!instance_place(x,y-4,obj_world))
{
//move up a maximum of 4
move_contact_solid(90,4)
//then move down a maximum of 4
move_contact_solid(270,4)
//since theyreboth not constant, it allows the unit flexibility in determining where it's y will be
}

//familiar stuff. If he hits something vertically, grav and vspeed bottom out
if(instance_place(x,y+vspeed+gravity,obj_world))
    {
    gravity=0
    vspeed=0
    }
else
    {
    gravity=0.5
    }

//this smooths out the horizontal movement speed. It will return to zero over a matter of frames
movespeed = movespeed/1.1

//if we are clicking, but not using a GUI element... (and in the right group)
if mouse_check_button(mb_left) and !mouse_on_GUI() and distance_to_point(mouse_x,y)&gt;32 and global.groupselected = group and standby = false
    {
    //tell him exactly where he actually wants to go
    destx = obj_control.groundx
    desty = obj_control.groundy
    
    //He must want to move to the mouse, so ramp up the movement speed by 0.5 every frame until it hits a max of 4
    movespeed = sign(destx-x)*min(4,abs(movespeed)+0.5)
    
    }

//if we are in fact moving...
if movespeed!=0
    {
    //decide where his next x coordinate should be
    next_x = x+movespeed
    //if the move is legitimate and will not cause him to clip into a wall, also going up 4 to see if it might just be a climbable slope
    if(!instance_place(next_x,y-4,obj_world))
    {
    //then move him to the next x
    x = next_x
    }
else
    {/*
    //if his next x is not legitimate, then we can see if jumping will get him there
    if(desty&lt;y and instance_place(x,y+4,obj_world) and !instance_place(x,y-10,obj_world))
        {
        //if jumping can work, then do it
        vspeed = -10
        }
    */
    }
}

//Lets jump over stuff if we should ---X
//If we're far enough away from our destination and if there's a place free...
if((x&lt;destx-4 or x&gt;destx+4) and !instance_place(x+(16*sign(destx-x)),y-80,obj_world) and instance_place(x+(8*sign(destx-x)),y-8,obj_world) and instance_place(x,y+1,obj_world) and movespeed!=0){
    vspeed = -10
}

//Now lets jump across gaps if we should
if(x&lt;destx-4 or x&gt;destx+4) and !instance_place(x+(32*sign(destx-x)),y+4,obj_world) and desty&lt;=y and instance_place(x,y+2,obj_world) and movespeed!=0{
    vspeed = -10
    //movespeed += 4*(sign(destx-x))
}

//If the unit isn't selected then he should be disabled
if(global.groupselected != group){
    disabled = true
}
else{
    disabled = false
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="4" ename="obj_unit">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(instance_place(x-(32*sign(other.x-x)),y+4,obj_world) and standby = false){
    movespeed -= sign(other.x-x)/4
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Draw the check for jumps
//draw_circle_color(x+(32*sign(destx-x)),y-4,3,c_red,c_red,0)

if(standby = true){
    image_alpha = 0.5
}
else{
    image_alpha = 1
}

image_yscale = scale
image_xscale = scale*dir

if(movespeed!=0)
dir = sign(movespeed)

drive += 10
vel = movespeed

ang = -dsin(drive)*10*vel
draw_sprite_ext(spr_unit_upperleg,0,x,y-140*image_yscale,image_xscale,image_yscale,ang,image_blend,image_alpha)
draw_sprite_ext(spr_unit_larm,0,x+planex(0,32,ang),y-140*image_yscale+planey(0,32,ang),image_xscale,image_yscale,ang-min(0,dsin(drive)*20)*vel,image_blend,image_alpha)

ang = -dsin(drive+180)*10*vel
draw_sprite_ext(spr_unit_upperleg,0,x,y-96*image_yscale,image_xscale,image_yscale,ang,image_blend,image_alpha)
draw_sprite_ext(spr_unit_foot,0,x+planex(0,32,ang),y-96*image_yscale+planey(0,32,ang),image_xscale,image_yscale,ang+min(0,dcos(drive+180)*30)*vel,image_blend,image_alpha)

draw_sprite_ext(spr_unit_dgear,0,x,y-138*image_yscale,image_xscale,image_yscale,drive*dir/10,image_blend,image_alpha)
draw_sprite_ext(spr_unit_tgear,0,x-21*image_xscale,y-105*image_yscale,image_xscale,image_yscale,-drive*(16/6)*dir/10,image_blend,image_alpha)
draw_sprite_ext(spr_unit_ngear,0,x+38*image_xscale,y-141*image_yscale,image_xscale,image_yscale,-drive*(2)*dir/10,image_blend,image_alpha)
draw_sprite_ext(spr_unit_torso,0,x,y-96*image_yscale,image_xscale,image_yscale,0,image_blend,image_alpha)
draw_sprite_ext(spr_unit_head,0,x+38*image_xscale,y-141*image_yscale,image_xscale,image_yscale,dsin(drive*3),image_blend,image_alpha)
draw_sprite_ext(spr_unit_jaw,0,x+50*image_xscale,y-126*image_yscale,image_xscale,image_yscale,dsin(drive*3),image_blend,image_alpha)

ang = -dsin(drive)*10*vel
draw_sprite_ext(spr_unit_upperleg,0,x,y-96*image_yscale,image_xscale,image_yscale,ang,image_blend,image_alpha)
draw_sprite_ext(spr_unit_foot,0,x+planex(0,32,ang),y-96*image_yscale+planey(0,32,ang),image_xscale,image_yscale,ang+min(0,dcos(drive)*30)*vel,image_blend,image_alpha)

ang = -dsin(drive+180)*10*vel
draw_sprite_ext(spr_unit_upperleg,0,x,y-140*image_yscale,image_xscale,image_yscale,ang,image_blend,image_alpha)
draw_sprite_ext(spr_unit_rarm,0,x+planex(0,32,ang),y-140*image_yscale+planey(0,32,ang),image_xscale,image_yscale,ang-min(0,dsin(drive+180)*20)*vel,image_blend,image_alpha)

image_yscale = 1
image_xscale = 1
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
